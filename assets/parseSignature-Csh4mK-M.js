import{R as b,b_ as y,bN as w,aa as x,c0 as p,co as z,cl as M,dV as k,cn as f,dW as N,a2 as T,dX as E,a9 as P,dY as S,bC as B,ch as L,dZ as _}from"./index-CjdIg9UX.js";function C(s,e){if(s.length!==e.length)throw new b({expectedLength:s.length,givenLength:e.length});const o=[];for(let t=0;t<s.length;t++){const g=s[t],i=e[t];o.push(m(g,i))}return y(o)}function m(s,e,o=!1){if(s==="address"){const n=e;if(!w(n))throw new x({address:n});return p(n.toLowerCase(),{size:o?32:null})}if(s==="string")return z(e);if(s==="bytes")return e;if(s==="bool")return p(M(e),{size:o?32:1});const t=s.match(k);if(t){const[n,r,c="256"]=t,a=Number.parseInt(c,10)/8;return f(e,{size:o?32:a,signed:r==="int"})}const g=s.match(N);if(g){const[n,r]=g;if(Number.parseInt(r,10)!==(e.length-2)/2)throw new T({expectedSize:Number.parseInt(r,10),givenSize:(e.length-2)/2});return p(e,{dir:"right",size:o?32:null})}const i=s.match(E);if(i&&Array.isArray(e)){const[n,r]=i,c=[];for(let a=0;a<e.length;a++)c.push(m(r,e[a],!0));return c.length===0?"0x":y(c)}throw new P(s)}function H(s){const{source:e}=s,o=new Map,t=new S(8192),g=new Map,i=({address:n,chainId:r})=>`${n}.${r}`;return{async consume({address:n,chainId:r,client:c}){const a=i({address:n,chainId:r}),u=this.get({address:n,chainId:r,client:c});this.increment({address:n,chainId:r});const d=await u;return await e.set({address:n,chainId:r},d),t.set(a,d),d},async increment({address:n,chainId:r}){const c=i({address:n,chainId:r}),a=o.get(c)??0;o.set(c,a+1)},async get({address:n,chainId:r,client:c}){const a=i({address:n,chainId:r});let u=g.get(a);return u||(u=(async()=>{try{const l=await e.get({address:n,chainId:r,client:c}),h=t.get(a)??0;return h>0&&l<=h?h+1:(t.delete(a),l)}finally{this.reset({address:n,chainId:r})}})(),g.set(a,u)),(o.get(a)??0)+await u},reset({address:n,chainId:r}){const c=i({address:n,chainId:r});o.delete(c),g.delete(c)}}}const A="0x6492649264926492649264926492649264926492649264926492649264926492";function V(s){const{address:e,data:o,signature:t,to:g="hex"}=s,i=y([B([{type:"address"},{type:"bytes"},{type:"bytes"}],[e,o,t]),A]);return g==="hex"?i:L(i)}function $(s){const{r:e,s:o}=_.Signature.fromCompact(s.slice(2,130)),t=+`0x${s.slice(130)}`,[g,i]=(()=>{if(t===0||t===1)return[void 0,t];if(t===27)return[BigInt(t),0];if(t===28)return[BigInt(t),1];throw new Error("Invalid yParityOrV value")})();return typeof g<"u"?{r:f(e,{size:32}),s:f(o,{size:32}),v:g,yParity:i}:{r:f(e,{size:32}),s:f(o,{size:32}),yParity:i}}export{H as c,C as e,$ as p,V as s};
